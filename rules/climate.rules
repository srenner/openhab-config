import org.openhab.model.script.actions.*
import org.joda.time.*

rule "Vacation On"
when
	Item sw_Vacation update ON
then
	sendCommand(HVAC_HeatSetPoint, 62)
end

rule "Vacation Off"
when
	Item sw_Vacation update OFF
then
	sendCommand(HVAC_HeatSetPoint, 68)
end

rule "WFH On"
when
        Item sw_WFH received update ON
then
	if(sw_WorkDay.state == ON) {
		sendCommand(HVAC_HeatSetPoint, 68)
	}
end

rule "Downstairs HVAC - Before Work"
when
	Time cron "0 45 5 ? * MON-FRI"
then
	if(sw_Vacation.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 68)
	}
end	

rule "Downstairs HVAC - Before Work on Workout Mornings"
when
	Time cron "0 30 5 ? * TUE-THU"
then
	if(sw_Vacation.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 68)
	}
end

rule "Downstairs HVAC - During Work"
when
	Time cron "0 15 7 ? * MON-FRI"
then
	sendCommand(sw_WorkDay, ON)
	if(sw_WFH.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 62)
	}
end

rule "Downstairs HVAC - Afternoon Checkpoint 1"
when
	Time cron "0 45 15 ? * MON-FRI"
then
	if(sw_Vacation.state == OFF) {
		if(wx_Temperature.state < 25.0) {
			if(HVAC_HeatSetPoint.state < 66) {
				sendCommand(HVAC_HeatSetPoint, 66)
			}
		}
	}
end

rule "Downstairs HVAC - Afternoon Checkpoint 2"
when
	Time cron "0 0 16 ? * MON-FRI"
then
	if(sw_Vacation.state == OFF) {
		if(wx_Temperature.state < 35.0) {
			if(HVAC_HeatSetPoint.state < 66) {
				sendCommand(HVAC_HeatSetPoint, 66)
			}
		}
	}
end

rule "Downstairs HVAC - Home From Work"
when
	Time cron "0 30 16 ? * MON-FRI"
then
	if(sw_Vacation.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 68)
	}
	else {
		sendCommand(HVAC_HeatSetPoint, 62)
	}
	sendCommand(sw_WorkDay, OFF)
	sendCommand(sw_WFH, OFF)
end

rule "Downstairs HVAC - Bedtime"
when
	Time cron "0 15 22 ? * MON-SUN"
then
	if(sw_Vacation.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 65)
	}
end

rule "Downstairs HVAC - Weekend"
when
	Time cron "0 0 7 ? * SAT-SUN"
then
	if(sw_Vacation.state == OFF) {
		sendCommand(HVAC_HeatSetPoint, 68)
	}
	else {
		sendCommand(HVAC_HeatSetPoint, 62)
	}
end
